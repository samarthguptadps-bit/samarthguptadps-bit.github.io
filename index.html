<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ROBO-MATH | CREATED BY SAMARTH</title>
    <style>
        :root {
            --neon-blue: #00f2ff;
            --neon-orange: #ff9d00;
            --neon-purple: #bc13fe;
            --neon-green: #39ff14;
            --bright-bg: #050a1f;
            --card-bg: rgba(15, 25, 55, 0.98);
        }

        body {
            background-color: var(--bright-bg);
            background-image: radial-gradient(circle at 50% 50%, #1e3a8a 0%, #050a1f 100%);
            color: white; font-family: 'Arial Black', sans-serif; margin: 0;
            display: flex; flex-direction: column; align-items: center;
            min-height: 100vh; overflow-x: hidden;
        }

        .creator-banner {
            width: 100%; background: linear-gradient(90deg, #ff0000, #ff9d00, #00f2ff, #bc13fe, #ff0000);
            background-size: 400% 400%; animation: gradientMove 8s ease infinite;
            padding: 10px 0; text-align: center; border-bottom: 4px solid gold;
        }
        @keyframes gradientMove { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        .creator-name { font-size: 2rem; color: white; text-shadow: 0 0 10px #000; letter-spacing: 2px; }

        .id-card { background: var(--card-bg); padding: 15px; width: 100%; display: flex; justify-content: center; gap: 10px; border-bottom: 3px solid var(--neon-blue); flex-wrap: wrap; }
        .id-card input { border: 2px solid var(--neon-purple); padding: 8px; font-weight: 900; width: 180px; border-radius: 5px; background: #000; color: white; text-align: center; }

        .nav-switch { margin: 20px 0; display: flex; gap: 10px; background: rgba(255,255,255,0.1); padding: 10px; border-radius: 50px; border: 2px solid var(--neon-blue); }
        .nav-btn { padding: 10px 30px; border: none; border-radius: 40px; cursor: pointer; font-weight: bold; font-size: 1.1rem; transition: 0.3s; background: transparent; color: white; }
        .nav-btn.active { background: var(--neon-blue); color: #000; box-shadow: 0 0 15px var(--neon-blue); }

        .full-section { width: 95%; display: none; padding-bottom: 50px; }
        .full-section.active { display: block; }

        /* --- TIC TAC TOE --- */
        .ttt-box { max-width: 450px; margin: 30px auto; background: var(--card-bg); padding: 20px; border-radius: 20px; border: 3px solid var(--neon-blue); text-align: center; }
        .ttt-controls { margin-bottom: 15px; display: flex; justify-content: center; gap: 10px; }
        .ttt-grid { display: grid; gap: 5px; background: var(--neon-blue); padding: 5px; border-radius: 10px; margin: 0 auto; width: fit-content;}
        .cell { background: white; color: black; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; cursor: pointer; border-radius: 5px; transition: 0.2s; }
        .cell.win { background: gold; color: black; animation: pulse 1s infinite; }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }

        /* --- SUDOKU --- */
        .sudoku-container { display: flex; flex-wrap: wrap; gap: 15px; justify-content: center; margin-bottom: 30px; }
        .sudoku-board { display: grid; grid-template-columns: repeat(9, 22px); grid-template-rows: repeat(9, 22px); border: 2px solid white; background: white; padding: 1px; }
        .board-title { text-align: center; font-size: 0.7rem; color: var(--neon-blue); margin-bottom: 5px;}
        .s-cell { width: 22px; height: 22px; border: 0.1px solid #ccc; color: black; font-size: 12px; text-align: center; line-height: 22px; }
        .s-cell input { width: 100%; height: 100%; border: none; text-align: center; font-weight: bold; background: transparent; }
        .s-fixed { background: #e0e0e0; font-weight: bold; color: #333; }

        /* --- MATH CORES --- */
        .game-block { 
            background: var(--card-bg); 
            border: 2px solid var(--neon-purple); 
            border-radius: 20px; 
            padding: 20px; 
            position: relative; 
            transition: 0.5s; 
            overflow: hidden; 
            margin-bottom: 20px;
        }
        .core-overlay { position: absolute; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.85); display: flex; align-items: center; justify-content: center; z-index: 5; transition: 0.5s; }
        .activate-btn { background: var(--neon-blue); color: black; padding: 15px 30px; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; font-size: 1.2rem; box-shadow: 0 0 20px var(--neon-blue); }
        .game-block.unlocked .core-overlay { opacity: 0; pointer-events: none; }
        
        .timer-display { 
            position: absolute; top: 15px; right: 15px;
            background: rgba(255, 0, 0, 0.15); border: 1px solid #ff0000;
            padding: 5px 12px; border-radius: 8px; color: #ff3333; 
            font-size: 1rem; font-family: 'Courier New', monospace; font-weight: bold;
            box-shadow: 0 0 10px rgba(255, 0, 0, 0.3); z-index: 2;
        }

        /* RESET BUTTON STYLE */
        .reset-container {
            position: absolute; top: 10px; right: 10px;
            display: flex; flex-direction: column; align-items: flex-end; gap: 5px; z-index: 3;
        }
        .mastered-label { color: var(--neon-green); font-size: 0.7rem; text-shadow: 0 0 5px var(--neon-green); }
        .reset-btn {
            background: #222; color: #fff; border: 1px solid var(--neon-orange);
            padding: 4px 10px; border-radius: 4px; cursor: pointer; font-size: 0.8rem;
            transition: 0.3s;
        }
        .reset-btn:hover { background: var(--neon-orange); color: #000; }

        .chip { background: white; color: black; padding: 10px; margin: 8px 0; cursor: grab; border-radius: 8px; font-size: 0.9rem; text-align: center; font-weight: bold; width: 85%; }
        .slot { background: #000; border: 2px dashed var(--neon-blue); min-height: 45px; margin: 8px 0; border-radius: 8px; color: var(--neon-orange); display: flex; align-items: center; justify-content: center; width: 110px; }
        .slot.filled { border-style: solid; background: rgba(0, 242, 255, 0.1); }

        /* --- POPUP MODAL --- */
        #custom-modal { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; color: black; padding: 30px; border-radius: 15px; border: 5px solid var(--neon-blue); z-index: 100; text-align: center; box-shadow: 0 0 50px rgba(0,0,0,0.5); }
        .overlay-bg { display: none; position: fixed; top:0; left:0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 99; }
    </style>
</head>
<body>

<div id="custom-modal">
    <h1 id="modal-msg" style="margin: 0 0 20px 0;">CONGRATULATIONS!</h1>
    <button onclick="closeModal()" style="padding: 10px 20px; background: var(--neon-purple); color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold;">CONTINUE</button>
</div>
<div class="overlay-bg" id="modal-overlay"></div>

<div class="creator-banner">
    <div class="creator-name">⭐ SAMARTH ⭐</div>
    <div style="color: white; font-size: 0.9rem;">ROBO-MATH MASTER EDITION</div>
</div>

<div class="id-card">
    <input type="text" id="player-name" placeholder="ENTER NAME">
    <input type="text" id="player-class" placeholder="ENTER CLASS">
    <input type="text" id="player-roll" placeholder="ROLL NO.">
</div>

<div class="nav-switch">
    <button class="nav-btn active" onclick="showSection('section-a', this)">SECTION A: LOGIC</button>
    <button class="nav-btn" onclick="showSection('section-b', this)">SECTION B: MATH</button>
</div>

<div id="section-a" class="full-section active">
    <h2 style="text-align:center; color: var(--neon-orange);">SUDOKU VAULT (LEVELS 1-6) & TIC TAC TOE</h2>
    <div class="sudoku-container" id="sudoku-vault"></div>
    <div class="ttt-box">
        <div class="ttt-controls">
            <button onclick="setTTTSize(3)" id="btn3" style="background:var(--neon-blue); padding:5px 15px; border-radius:5px; border:none; cursor:pointer; font-weight:bold;">3x3</button>
            <button onclick="setTTTSize(4)" id="btn4" style="background:gray; padding:5px 15px; border-radius:5px; border:none; cursor:pointer; font-weight:bold; color:white;">4x4</button>
        </div>
        <div class="ttt-grid" id="ttt-board"></div>
        <div id="ttt-status" style="margin-top:15px; font-weight:bold;">X's TURN</div>
        <button onclick="resetTTT()" style="margin-top:10px; cursor:pointer; background:var(--neon-purple); color:white; border:none; padding:8px 20px; border-radius:5px;">RESTART GAME</button>
    </div>
</div>

<div id="section-b" class="full-section">
    <h2 style="text-align:center; color: var(--neon-blue);">MATH CORES (10 ITEMS EACH)</h2>
    <div class="math-container" id="master-container"></div>
</div>

<script>
    function showSection(sid, btn) {
        document.querySelectorAll('.full-section').forEach(s => s.classList.remove('active'));
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        document.getElementById(sid).classList.add('active');
        btn.classList.add('active');
    }

    function getName() { return document.getElementById('player-name').value || "Player"; }

    function roboSpeak(message) {
        window.speechSynthesis.cancel();
        const speech = new SpeechSynthesisUtterance(message);
        speech.volume = 1; speech.rate = 1; speech.pitch = 1;
        window.speechSynthesis.speak(speech);
    }

    function showPopup(msg) {
        document.getElementById('modal-msg').innerText = msg;
        document.getElementById('custom-modal').style.display = 'block';
        document.getElementById('modal-overlay').style.display = 'block';
    }

    function closeModal() {
        document.getElementById('custom-modal').style.display = 'none';
        document.getElementById('modal-overlay').style.display = 'none';
    }

    // --- TIC TAC TOE (Fixed Reset) ---
    let tttSize = 3, tttB = [], turn = 'X', active = true;
    function setTTTSize(s) { tttSize = s; resetTTT(); }
    function resetTTT() { turn = 'X'; active = true; document.getElementById('ttt-status').innerText = "X's TURN"; initTTT(); }
    function initTTT() {
        const b = document.getElementById('ttt-board');
        b.innerHTML = ''; b.style.gridTemplateColumns = `repeat(${tttSize}, 80px)`;
        tttB = Array(tttSize * tttSize).fill(null);
        for(let i=0; i<tttB.length; i++) {
            const c = document.createElement('div'); c.className = 'cell';
            c.style.width = '80px'; c.style.height = '80px';
            c.onclick = () => {
                if(!tttB[i] && active) {
                    tttB[i] = turn; c.innerText = turn;
                    const winIndices = checkTTT();
                    if(winIndices) {
                        active = false; winIndices.forEach(idx => b.children[idx].classList.add('win'));
                        let msg = `PLAYER ${turn} WINS!`; roboSpeak(msg); showPopup(msg);
                    } else if(!tttB.includes(null)) {
                        roboSpeak("Draw!"); showPopup("It's a Draw!");
                    } else {
                        turn = turn === 'X' ? 'O' : 'X';
                        document.getElementById('ttt-status').innerText = `${turn}'s TURN`;
                    }
                }
            };
            b.appendChild(c);
        }
    }
    function checkTTT() {
        const size = tttSize;
        for(let r=0; r<size; r++) {
            let row = []; for(let c=0; c<size; c++) row.push(r*size + c);
            if(row.every(i => tttB[i] === turn)) return row;
        }
        for(let c=0; c<size; c++) {
            let col = []; for(let r=0; r<size; r++) col.push(r*size + c);
            if(col.every(i => tttB[i] === turn)) return col;
        }
        let d1 = [], d2 = [];
        for(let i=0; i<size; i++) { d1.push(i*size + i); d2.push(i*size + (size - 1 - i)); }
        if(d1.every(i => tttB[i] === turn)) return d1;
        if(d2.every(i => tttB[i] === turn)) return d2;
        return null;
    }

    // --- SUDOKU ---
    const sudokus = [
        { lvl: 1, sol: "534678912672195348198342567859761423426853791713924856961537284287419635345286179", puzzle: "5346789126721953481983425678.9761423426853791713924856961.537284287419635345286179" },
        { lvl: 2, sol: "126437958895621473374985126457193862983246517612578349748359261569124738231867945", puzzle: "1264379588956214733749.512645719386298324651761257.349748359261569124738231867945" },
        { lvl: 3, sol: "276314958854962713913875264468127395597438621132596847689741532345289176721653489", puzzle: "2.63149588549.27139138752644.81273955974.862113259.8476897415323452.917672165.489" },
        { lvl: 4, sol: "491873256325469718687215439149387625576124983832956147714632895968541372253798641", puzzle: "4918.32563254697186872.54391493876.557612498383295.147714632895.685413722537.8641" },
        { lvl: 5, sol: "912345678345678912678912345123456789456789123789123456234567891567891234891234567", puzzle: "9.23.56.8345...912.7.9123.5.234567894.6789.2378912345623.5.7.9.5678912348.12.45.7" },
        { lvl: 6, sol: "123456789456789123789123456231564897564897231897231564312645978645978312978312645", puzzle: "1.3.5.7.94.6.8.1.37.9.2.4.62..5..8..5.4...2.1..7..1..43.2.4.9.86.5.7.3.29.8.1.6.5" }
    ];
    function initSudoku() {
        const v = document.getElementById('sudoku-vault'); v.innerHTML = '';
        sudokus.forEach((s, idx) => {
            const wrap = document.createElement('div');
            wrap.innerHTML = `<div class="board-title">SUDOKU LVL ${s.lvl}</div>`;
            const b = document.createElement('div'); b.className = 'sudoku-board'; b.id = `s-${idx}`;
            for(let i=0; i<81; i++) {
                const cell = document.createElement('div'); cell.className = 's-cell';
                if(s.puzzle[i] !== '.') { cell.innerText = s.puzzle[i]; cell.classList.add('s-fixed'); }
                else { const inp = document.createElement('input'); inp.maxLength = 1; inp.oninput = () => checkS(idx); cell.appendChild(inp); }
                b.appendChild(cell);
            }
            wrap.appendChild(b); v.appendChild(wrap);
        });
    }
    function checkS(idx) {
        const b = document.getElementById(`s-${idx}`); const inps = b.querySelectorAll('input');
        let str = "", inpIdx = 0;
        for(let i=0; i<81; i++) { if(sudokus[idx].puzzle[i] !== '.') str += sudokus[idx].puzzle[i]; else { str += inps[inpIdx].value; inpIdx++; } }
        if(str === sudokus[idx].sol && !b.dataset.win) {
            b.dataset.win = "true"; roboSpeak(`Level ${sudokus[idx].lvl} Solved!`); showPopup(`Sudoku Level ${sudokus[idx].lvl} Solved!`);
        }
    }

    // --- MATH CORES ---
    const gameData = {
        g1: { title: "EXPONENTS CORE", time: 120, pairs: [{q:"2³", a:"8"}, {q:"3²", a:"9"}, {q:"5²", a:"25"}, {q:"4²", a:"16"}, {q:"10²", a:"100"}, {q:"1³", a:"1"}, {q:"6²", a:"36"}, {q:"2⁴", a:"16"}, {q:"3³", a:"27"}, {q:"2²", a:"4"}]},
        g2: { title: "FRAC TO DEC CORE", time: 240, pairs: [{q:"1/2", a:"0.5"}, {q:"1/4", a:"0.25"}, {q:"3/4", a:"0.75"}, {q:"1/5", a:"0.2"}, {q:"2/5", a:"0.4"}, {q:"4/5", a:"0.8"}, {q:"1/10", a:"0.1"}, {q:"1/8", a:"0.125"}, {q:"1/20", a:"0.05"}, {q:"1/100", a:"0.01"}]},
        g3: { title: "PERC TO FRAC CORE", time: 240, pairs: [{q:"50%", a:"1/2"}, {q:"25%", a:"1/4"}, {q:"75%", a:"3/4"}, {q:"20%", a:"1/5"}, {q:"40%", a:"2/5"}, {q:"60%", a:"3/5"}, {q:"80%", a:"4/5"}, {q:"10%", a:"1/10"}, {q:"100%", a:"1/1"}, {q:"5%", a:"1/20"}]},
        g4: { title: "PERC TO DEC CORE", time: 240, pairs: [{q:"10%", a:"0.1"}, {q:"50%", a:"0.5"}, {q:"25%", a:"0.25"}, {q:"1%", a:"0.01"}, {q:"100%", a:"1.0"}, {q:"5%", a:"0.05"}, {q:"20%", a:"0.2"}, {q:"75%", a:"0.75"}, {q:"30%", a:"0.3"}, {q:"90%", a:"0.9"}]}
    };
    let timers = {};

    function initMath() {
        const v = document.getElementById('master-container'); v.innerHTML = '';
        Object.keys(gameData).forEach(id => renderCore(id));
    }

    function renderCore(id) {
        const v = document.getElementById('master-container');
        const data = gameData[id];
        const block = document.createElement('div'); block.className = 'game-block'; block.id = `block-${id}`;
        block.innerHTML = `
            <div class="core-overlay"><button class="activate-btn" onclick="activateCore('${id}')">ACTIVATE CORE</button></div>
            <div id="timer-${id}" class="timer-display">SYNCING...</div>
            <h3 style="color:var(--neon-orange); text-align:left; margin-bottom:5px;">${data.title}</h3>
            <div style="display:flex; justify-content:space-between; align-items: flex-start; margin-top:15px;">
                <div id="q-${id}" style="width:55%"></div><div id="a-${id}" style="width:35%"></div>
            </div>`;
        
        const shuffledQs = [...data.pairs].sort(()=>Math.random()-0.5);
        const shuffledAs = [...data.pairs].sort(()=>Math.random()-0.5);
        shuffledQs.forEach((p, i) => {
            const q = document.createElement('div'); q.className = 'chip'; q.innerText = p.q; q.draggable = true; q.dataset.ans = p.a; q.id = `${id}-q-${i}`;
            q.ondragstart = (e) => e.dataTransfer.setData("text", e.target.id);
            block.querySelector(`#q-${id}`).appendChild(q);
        });
        shuffledAs.forEach((p, i) => {
            const s = document.createElement('div'); s.className = 'slot'; s.dataset.ans = p.a; s.innerText = p.a;
            s.ondragover = (e) => e.preventDefault();
            s.ondrop = (e) => {
                const tid = e.dataTransfer.getData("text"); const t = document.getElementById(tid);
                if(t.dataset.ans === e.target.dataset.ans) { e.target.innerHTML = ""; e.target.appendChild(t); e.target.classList.add('filled'); checkGameComplete(id); }
            };
            block.querySelector(`#a-${id}`).appendChild(s);
        });
        v.appendChild(block);
    }

    function activateCore(id) {
        document.getElementById(`block-${id}`).classList.add('unlocked');
        startTimer(id, gameData[id].time);
    }

    function startTimer(id, seconds) {
        clearInterval(timers[id]);
        let timeLeft = seconds;
        const display = document.getElementById(`timer-${id}`);
        timers[id] = setInterval(() => {
            let m = Math.floor(timeLeft / 60); let s = timeLeft % 60;
            display.innerText = `${m}:${s < 10 ? '0' : ''}${s}`;
            if (timeLeft <= 0) {
                clearInterval(timers[id]);
                resetSpecificCore(id);
                roboSpeak("Time is up!");
            }
            timeLeft--;
        }, 1000);
    }

    function checkGameComplete(id) {
        const slots = document.getElementById(`block-${id}`).querySelectorAll('.slot.filled');
        if(slots.length === 10) {
            clearInterval(timers[id]);
            roboSpeak(`Core ${gameData[id].title} Mastered!`);
            showPopup(`Core Mastered!`);
            
            // UI Update: Remove Timer, Add Reset Option
            const timerDiv = document.getElementById(`timer-${id}`);
            timerDiv.style.display = 'none';
            
            const resetContainer = document.createElement('div');
            resetContainer.className = 'reset-container';
            resetContainer.innerHTML = `
                <span class="mastered-label">CORE MASTERED ✓</span>
                <button class="reset-btn" onclick="resetSpecificCore('${id}')">RESET CORE</button>
            `;
            document.getElementById(`block-${id}`).appendChild(resetContainer);
        }
    }

    function resetSpecificCore(id) {
        clearInterval(timers[id]);
        const oldBlock = document.getElementById(`block-${id}`);
        const container = document.getElementById('master-container');
        
        // Logic to replace just this specific core block
        const newBlock = document.createElement('div');
        container.replaceChild(newBlock, oldBlock);
        
        // Re-render this specific core
        const data = gameData[id];
        newBlock.className = 'game-block'; newBlock.id = `block-${id}`;
        newBlock.innerHTML = `
            <div class="core-overlay"><button class="activate-btn" onclick="activateCore('${id}')">ACTIVATE CORE</button></div>
            <div id="timer-${id}" class="timer-display">SYNCING...</div>
            <h3 style="color:var(--neon-orange); text-align:left; margin-bottom:5px;">${data.title}</h3>
            <div style="display:flex; justify-content:space-between; align-items: flex-start; margin-top:15px;">
                <div id="q-${id}" style="width:55%"></div><div id="a-${id}" style="width:35%"></div>
            </div>`;
        
        const shuffledQs = [...data.pairs].sort(()=>Math.random()-0.5);
        const shuffledAs = [...data.pairs].sort(()=>Math.random()-0.5);
        shuffledQs.forEach((p, i) => {
            const q = document.createElement('div'); q.className = 'chip'; q.innerText = p.q; q.draggable = true; q.dataset.ans = p.a; q.id = `${id}-q-${i}`;
            q.ondragstart = (e) => e.dataTransfer.setData("text", e.target.id);
            newBlock.querySelector(`#q-${id}`).appendChild(q);
        });
        shuffledAs.forEach((p, i) => {
            const s = document.createElement('div'); s.className = 'slot'; s.dataset.ans = p.a; s.innerText = p.a;
            s.ondragover = (e) => e.preventDefault();
            s.ondrop = (e) => {
                const tid = e.dataTransfer.getData("text"); const t = document.getElementById(tid);
                if(t.dataset.ans === e.target.dataset.ans) { e.target.innerHTML = ""; e.target.appendChild(t); e.target.classList.add('filled'); checkGameComplete(id); }
            };
            newBlock.querySelector(`#a-${id}`).appendChild(s);
        });
    }

    window.onload = () => { initSudoku(); initTTT(); initMath(); };
</script>
</body>
</html>
